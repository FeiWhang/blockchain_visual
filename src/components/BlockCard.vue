<script setup lang="ts">
import { Block, Chain } from "@/composables/blockchain";
import { Ref, ref, onBeforeMount } from "vue";
import LoadingCircle from "@/components/LoadingCircle.vue";

const props = defineProps({
  block: Block,
  chain: Chain,
});

const block = ref(props.block ?? new Block(0)) as Ref<Block>;
const status: Ref<string> = ref<string>("Valid hash starts with 0000.");

const isMining = ref(false) as Ref<boolean>;
function onMineClicked() {
  if (block.value.isHashValid()) return;
  isMining.value = true;
  setTimeout(async () => {
    await block.value.mine();
    isMining.value = false;
    if (props.chain) props.chain.updateHash(block.value.index);
  }, 1000);
}
function onDataChange() {
  if (props.chain) {
    props.chain.updateHash(block.value.index);
  } else {
    block.value.reHash();
  }
}
</script>

<template>
  <div class="BlockCard">
    <div class="BlockCard__header">
      <p class="BlockCard__index">
        <svg
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          v-if="block.isHashValid() && !isMining"
        >
          <path
            d="M8 12.5L11 15.5L16 9.5"
            stroke="var(--green)"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
          <path
            d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z"
            stroke="var(--green)"
            stroke-width="2"
          />
        </svg>
        <LoadingCircle v-if="!block.isHashValid() && isMining" />
        <svg
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          v-if="!block.isHashValid() && !isMining"
        >
          <path
            d="M16.34 9.32205C16.4361 9.23249 16.5135 9.12488 16.568 9.00538C16.6225 8.88587 16.6529 8.75681 16.6575 8.62555C16.6621 8.4943 16.6408 8.36342 16.5948 8.2404C16.5488 8.11737 16.4791 8.00461 16.3895 7.90855C16.2999 7.81249 16.1923 7.73501 16.0728 7.68053C15.9533 7.62605 15.8243 7.59565 15.693 7.59105C15.5617 7.58646 15.4309 7.60776 15.3078 7.65374C15.1848 7.69972 15.0721 7.76949 14.976 7.85905L12.05 10.587L9.322 7.66005C9.13947 7.47309 8.89101 7.36501 8.62979 7.35891C8.36858 7.35282 8.11535 7.44921 7.92431 7.62745C7.73326 7.8057 7.61956 8.05164 7.60754 8.31265C7.59552 8.57366 7.68614 8.829 7.86 9.02405L10.588 11.95L7.661 14.6781C7.56154 14.7667 7.48081 14.8743 7.42353 14.9946C7.36625 15.1149 7.33359 15.2454 7.32746 15.3785C7.32134 15.5116 7.34187 15.6446 7.38785 15.7696C7.43383 15.8947 7.50433 16.0093 7.59522 16.1067C7.68611 16.2041 7.79554 16.2824 7.9171 16.3369C8.03866 16.3915 8.1699 16.4212 8.30309 16.4243C8.43629 16.4274 8.56876 16.4038 8.69273 16.355C8.8167 16.3062 8.92967 16.2331 9.025 16.14L11.951 13.413L14.679 16.3391C14.7671 16.4403 14.8747 16.5229 14.9953 16.5817C15.116 16.6405 15.2472 16.6745 15.3813 16.6815C15.5153 16.6885 15.6494 16.6685 15.7756 16.6226C15.9017 16.5767 16.0173 16.5058 16.1155 16.4143C16.2137 16.3228 16.2924 16.2124 16.3471 16.0898C16.4017 15.9672 16.4311 15.8348 16.4334 15.7006C16.4358 15.5664 16.4111 15.4331 16.3609 15.3086C16.3107 15.1841 16.2359 15.071 16.141 14.976L13.414 12.05L16.34 9.32205V9.32205Z"
            fill="var(--redError)"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M1 12C1 5.925 5.925 1 12 1C18.075 1 23 5.925 23 12C23 18.075 18.075 23 12 23C5.925 23 1 18.075 1 12ZM12 21C10.8181 21 9.64778 20.7672 8.55585 20.3149C7.46392 19.8626 6.47177 19.1997 5.63604 18.364C4.80031 17.5282 4.13738 16.5361 3.68508 15.4442C3.23279 14.3522 3 13.1819 3 12C3 10.8181 3.23279 9.64778 3.68508 8.55585C4.13738 7.46392 4.80031 6.47177 5.63604 5.63604C6.47177 4.80031 7.46392 4.13738 8.55585 3.68508C9.64778 3.23279 10.8181 3 12 3C14.3869 3 16.6761 3.94821 18.364 5.63604C20.0518 7.32387 21 9.61305 21 12C21 14.3869 20.0518 16.6761 18.364 18.364C16.6761 20.0518 14.3869 21 12 21Z"
            fill="var(--redError)"
          />
        </svg>

        Block #{{ block.index == 0 ? "Genesis" : block.index }} <br />
      </p>
      <p
        class="BlockCard__nounce Section__placeholder"
        title="nounce"
        :style="{
          'background-color': block.isHashValid()
            ? 'var(--mainColor21)'
            : 'var(--redInput)',
        }"
      >
        <svg viewBox="0 0 36 42" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M0 37.3846V4.15385C4.26078e-05 3.30015 0.26312 2.4672 0.753431 1.76834C1.24374 1.06949 1.93747 0.538681 2.74021 0.248151C3.54295 -0.0423789 4.41571 -0.0785185 5.23972 0.144651C6.06374 0.367821 6.79898 0.83946 7.34539 1.49538L27.6923 25.9103V4.15385C27.6923 3.05218 28.1299 1.99563 28.9089 1.21663C29.6879 0.437636 30.7445 0 31.8462 0C32.9478 0 34.0044 0.437636 34.7834 1.21663C35.5624 1.99563 36 3.05218 36 4.15385V37.3846C36 38.2383 35.7369 39.0713 35.2466 39.7701C34.7563 40.469 34.0625 40.9998 33.2598 41.2903C32.4571 41.5808 31.5843 41.617 30.7603 41.3938C29.9363 41.1706 29.201 40.699 28.6546 40.0431L8.30769 15.6268V37.3846C8.30769 37.9301 8.20025 38.4703 7.9915 38.9742C7.78275 39.4782 7.47678 39.9361 7.09106 40.3218C6.70534 40.7075 6.24742 41.0135 5.74345 41.2223C5.23949 41.431 4.69934 41.5385 4.15385 41.5385C3.60836 41.5385 3.06821 41.431 2.56424 41.2223C2.06027 41.0135 1.60235 40.7075 1.21663 40.3218C0.830913 39.9361 0.524943 39.4782 0.316192 38.9742C0.107442 38.4703 -1.14954e-08 37.9301 0 37.3846ZM2.76923 4.15385V37.3846C2.76923 37.7518 2.91511 38.104 3.17478 38.3637C3.43444 38.6234 3.78662 38.7692 4.15385 38.7692C4.52107 38.7692 4.87325 38.6234 5.13292 38.3637C5.39258 38.104 5.53846 37.7518 5.53846 37.3846V11.8025C5.53859 11.518 5.62633 11.2405 5.78974 11.0077C5.95315 10.7748 6.18432 10.598 6.45179 10.5011C6.71926 10.4043 7.01006 10.3922 7.28465 10.4665C7.55924 10.5408 7.80428 10.6978 7.98646 10.9163L30.7828 38.2708C30.9649 38.4892 31.21 38.6463 31.4846 38.7206C31.7592 38.7948 32.05 38.7827 32.3174 38.6859C32.5849 38.5891 32.8161 38.4123 32.9795 38.1794C33.1429 37.9466 33.2306 37.6691 33.2308 37.3846V4.15385C33.2308 3.78662 33.0849 3.43444 32.8252 3.17478C32.5656 2.91511 32.2134 2.76923 31.8462 2.76923C31.4789 2.76923 31.1267 2.91511 30.8671 3.17478C30.6074 3.43444 30.4615 3.78662 30.4615 4.15385V29.736C30.4614 30.0205 30.3737 30.298 30.2103 30.5308C30.0468 30.7636 29.8157 30.9405 29.5482 31.0373C29.2807 31.1341 28.9899 31.1462 28.7154 31.0719C28.4408 30.9977 28.1957 30.8406 28.0135 30.6222L5.21723 3.26769L6.28062 2.38154L5.21723 3.26769C5.03505 3.04923 4.79001 2.89218 4.51542 2.8179C4.24083 2.74361 3.95003 2.75571 3.68256 2.85253C3.41508 2.94935 3.18392 3.12621 3.02051 3.35904C2.85709 3.59187 2.76936 3.86939 2.76923 4.15385Z"
            fill="black"
          />
        </svg>

        {{ block.nounce }}
      </p>
    </div>
    <form @submit.prevent class="Section__form BlockCard__form">
      <div class="Section__inputContainer" v-if="block.prevHash">
        <label for="prevHash" class="Section__label BlockCard__label--prevHash">
          <svg
            viewBox="0 0 32 32"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path d="M25 13V4H23V6H20V8H23V13H20V15H28V13H25Z" fill="black" />
            <path
              d="M8.5 6C9.19224 6 9.86893 6.20527 10.4445 6.58986C11.0201 6.97444 11.4687 7.52107 11.7336 8.16061C11.9985 8.80015 12.0678 9.50388 11.9328 10.1828C11.7977 10.8618 11.4644 11.4854 10.9749 11.9749C10.4854 12.4644 9.86175 12.7977 9.18282 12.9327C8.50389 13.0678 7.80015 12.9985 7.16061 12.7336C6.52107 12.4687 5.97444 12.0201 5.58986 11.4445C5.20527 10.8689 5 10.1922 5 9.5C5.00106 8.57207 5.37015 7.68244 6.0263 7.0263C6.68245 6.37015 7.57207 6.00106 8.5 6ZM8.5 4C7.41221 4 6.34884 4.32257 5.44437 4.92692C4.5399 5.53126 3.83495 6.39025 3.41867 7.39524C3.00238 8.40023 2.89346 9.5061 3.10568 10.573C3.3179 11.6399 3.84173 12.6199 4.61092 13.3891C5.3801 14.1583 6.36011 14.6821 7.42701 14.8943C8.4939 15.1065 9.59977 14.9976 10.6048 14.5813C11.6098 14.1651 12.4687 13.4601 13.0731 12.5556C13.6774 11.6512 14 10.5878 14 9.5C14 8.04131 13.4205 6.64236 12.3891 5.61091C11.3576 4.57946 9.95869 4 8.5 4Z"
              fill="black"
            />
            <path
              d="M23.5 20C24.1922 20 24.8689 20.2053 25.4445 20.5899C26.0201 20.9744 26.4687 21.5211 26.7336 22.1606C26.9985 22.8001 27.0678 23.5039 26.9328 24.1828C26.7977 24.8617 26.4644 25.4854 25.9749 25.9749C25.4854 26.4644 24.8618 26.7977 24.1828 26.9327C23.5039 27.0678 22.8002 26.9985 22.1606 26.7336C21.5211 26.4687 20.9744 26.0201 20.5899 25.4445C20.2053 24.8689 20 24.1922 20 23.5C20.0011 22.5721 20.3701 21.6824 21.0263 21.0263C21.6824 20.3701 22.5721 20.0011 23.5 20V20ZM23.5 18C22.4122 18 21.3488 18.3226 20.4444 18.9269C19.5399 19.5313 18.8349 20.3902 18.4187 21.3952C18.0024 22.4002 17.8935 23.5061 18.1057 24.573C18.3179 25.6399 18.8417 26.6199 19.6109 27.3891C20.3801 28.1583 21.3601 28.6821 22.427 28.8943C23.4939 29.1065 24.5998 28.9976 25.6048 28.5813C26.6098 28.1651 27.4687 27.4601 28.0731 26.5556C28.6774 25.6512 29 24.5878 29 23.5C29 22.0413 28.4205 20.6424 27.3891 19.6109C26.3576 18.5795 24.9587 18 23.5 18Z"
              fill="black"
            />
            <path
              d="M6 28V26H9.586L4 20.414L5.414 19L11 24.586V21H13V28H6Z"
              fill="black"
            />
          </svg>
          Previos hash</label
        >
        <div
          name="prevHash"
          class="Section__input Section__input--placeholder BlockCard__input BlockCard__input--prevHash"
          :style="{
            'background-color': block.isPrevHashValid()
              ? 'var(--mainColor21)'
              : 'var(--redInput)',
          }"
        >
          <p class="Section__placeholder">{{ block.prevHash }}</p>
        </div>
      </div>
      <div class="Section__inputContainer">
        <label for="hash" class="Section__label BlockCard__label--hash">
          <svg
            viewBox="0 0 32 32"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M8.5 6C9.19224 6 9.86893 6.20527 10.4445 6.58986C11.0201 6.97444 11.4687 7.52107 11.7336 8.16061C11.9985 8.80015 12.0678 9.50388 11.9328 10.1828C11.7977 10.8618 11.4644 11.4854 10.9749 11.9749C10.4854 12.4644 9.86175 12.7977 9.18282 12.9327C8.50389 13.0678 7.80015 12.9985 7.16061 12.7336C6.52107 12.4687 5.97444 12.0201 5.58986 11.4445C5.20527 10.8689 5 10.1922 5 9.5C5.00106 8.57207 5.37015 7.68244 6.0263 7.0263C6.68245 6.37015 7.57207 6.00106 8.5 6ZM8.5 4C7.41221 4 6.34884 4.32257 5.44437 4.92692C4.5399 5.53126 3.83495 6.39025 3.41867 7.39524C3.00238 8.40023 2.89346 9.5061 3.10568 10.573C3.3179 11.6399 3.84173 12.6199 4.61092 13.3891C5.3801 14.1583 6.36011 14.6821 7.42701 14.8943C8.4939 15.1065 9.59977 14.9976 10.6048 14.5813C11.6098 14.1651 12.4687 13.4601 13.0731 12.5556C13.6774 11.6512 14 10.5878 14 9.5C14 8.04131 13.4205 6.64236 12.3891 5.61091C11.3576 4.57946 9.95869 4 8.5 4Z"
              fill="black"
            />
            <path
              d="M23.5 20C24.1922 20 24.8689 20.2053 25.4445 20.5899C26.0201 20.9744 26.4687 21.5211 26.7336 22.1606C26.9985 22.8001 27.0678 23.5039 26.9328 24.1828C26.7977 24.8617 26.4644 25.4854 25.9749 25.9749C25.4854 26.4644 24.8618 26.7977 24.1828 26.9327C23.5039 27.0678 22.8002 26.9985 22.1606 26.7336C21.5211 26.4687 20.9744 26.0201 20.5899 25.4445C20.2053 24.8689 20 24.1922 20 23.5C20.0011 22.5721 20.3701 21.6824 21.0263 21.0263C21.6824 20.3701 22.5721 20.0011 23.5 20V20ZM23.5 18C22.4122 18 21.3488 18.3226 20.4444 18.9269C19.5399 19.5313 18.8349 20.3902 18.4187 21.3952C18.0024 22.4002 17.8935 23.5061 18.1057 24.573C18.3179 25.6399 18.8417 26.6199 19.6109 27.3891C20.3801 28.1583 21.3601 28.6821 22.427 28.8943C23.4939 29.1065 24.5998 28.9976 25.6048 28.5813C26.6098 28.1651 27.4687 27.4601 28.0731 26.5556C28.6774 25.6512 29 24.5878 29 23.5C29 22.0413 28.4205 20.6424 27.3891 19.6109C26.3576 18.5795 24.9587 18 23.5 18Z"
              fill="black"
            />
            <path
              d="M6 19V21H9.586L4 26.586L5.414 28L11 22.414V26H13V19H6Z"
              fill="black"
            />
            <path d="M20 14H27" stroke="black" stroke-width="2" />
            <path d="M26 5V9H21V13" stroke="black" stroke-width="2" />
            <path d="M20 5H27" stroke="black" stroke-width="2" />
          </svg>

          Hash</label
        >
        <div
          name="hash"
          class="Section__input Section__input--placeholder BlockCard__input BlockCard__input--hash"
          :style="{
            'background-color': block.isHashValid()
              ? 'var(--mainColor21)'
              : 'var(--redInput)',
          }"
        >
          <p class="Section__placeholder">
            {{ block.hash }}
          </p>
        </div>
        <label for="hash" class="Section__inputStatus BlockCard__inputStatus">
          <svg
            viewBox="0 0 16 16"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M1.5 1.5C1.36739 1.5 1.24021 1.55268 1.14645 1.64645C1.05268 1.74021 1 1.86739 1 2V6.8C1 7.1283 1.06466 7.45339 1.1903 7.75671C1.31594 8.06002 1.50009 8.33562 1.73223 8.56777C2.20107 9.03661 2.83696 9.3 3.5 9.3H13.293L9.946 12.646C9.85211 12.7399 9.79937 12.8672 9.79937 13C9.79937 13.1328 9.85211 13.2601 9.946 13.354C10.0399 13.4479 10.1672 13.5006 10.3 13.5006C10.4328 13.5006 10.5601 13.4479 10.654 13.354L14.854 9.154C14.9006 9.10755 14.9375 9.05238 14.9627 8.99163C14.9879 8.93089 15.0009 8.86577 15.0009 8.8C15.0009 8.73423 14.9879 8.66911 14.9627 8.60837C14.9375 8.54762 14.9006 8.49245 14.854 8.446L10.854 4.446C10.7601 4.35211 10.6328 4.29937 10.5 4.29937C10.3672 4.29937 10.2399 4.35211 10.146 4.446C10.0521 4.53989 9.99937 4.66722 9.99937 4.8C9.99937 4.93278 10.0521 5.06011 10.146 5.154L13.293 8.3H3.5C3.10218 8.3 2.72064 8.14196 2.43934 7.86066C2.15804 7.57936 2 7.19782 2 6.8V2C2 1.86739 1.94732 1.74021 1.85355 1.64645C1.75979 1.55268 1.63261 1.5 1.5 1.5V1.5Z"
              fill="black"
            />
          </svg>
          <span :key="block.isHashValid().toString()">{{
            block.isHashValid()
              ? "Valid hash starts with 0000."
              : "Invalid hash, please mine again."
          }}</span>
        </label>
      </div>
      <div class="Section__inputContainer">
        <label for="data" class="Section__label BlockCard__label--data">
          <svg
            viewBox="0 0 32 32"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M7 30C6.0111 30 5.0444 29.7068 4.22215 29.1574C3.39991 28.6079 2.75904 27.8271 2.3806 26.9134C2.00217 25.9998 1.90315 24.9945 2.09608 24.0246C2.289 23.0546 2.76521 22.1637 3.46447 21.4645C4.16373 20.7652 5.05465 20.289 6.02455 20.0961C6.99446 19.9031 7.99979 20.0022 8.91342 20.3806C9.82705 20.759 10.6079 21.3999 11.1573 22.2222C11.7068 23.0444 12 24.0111 12 25C11.9984 26.3256 11.4711 27.5964 10.5338 28.5338C9.59644 29.4711 8.3256 29.9984 7 30V30ZM7 22C6.40666 22 5.82664 22.1759 5.33329 22.5056C4.83994 22.8352 4.45543 23.3038 4.22836 23.852C4.0013 24.4001 3.94189 25.0033 4.05765 25.5853C4.1734 26.1672 4.45912 26.7018 4.87868 27.1213C5.29824 27.5409 5.83279 27.8266 6.41473 27.9424C6.99667 28.0581 7.59987 27.9987 8.14805 27.7716C8.69623 27.5446 9.16477 27.1601 9.49441 26.6667C9.82406 26.1734 10 25.5933 10 25C9.99921 24.2046 9.68288 23.442 9.12045 22.8796C8.55801 22.3171 7.79541 22.0008 7 22Z"
              fill="black"
            />
            <path
              d="M24 26H14V24H24V17H8C7.46973 16.9995 6.96133 16.7886 6.58637 16.4136C6.21141 16.0387 6.00053 15.5303 6 15V8C6.00053 7.46973 6.21141 6.96133 6.58637 6.58637C6.96133 6.21141 7.46973 6.00053 8 6H18V8H8V15H24C24.5303 15.0005 25.0387 15.2114 25.4136 15.5864C25.7886 15.9613 25.9995 16.4697 26 17V24C25.9995 24.5303 25.7886 25.0387 25.4136 25.4136C25.0387 25.7886 24.5303 25.9995 24 26V26Z"
              fill="black"
            />
            <path
              d="M28 12H22C21.4697 11.9995 20.9613 11.7886 20.5864 11.4136C20.2114 11.0387 20.0005 10.5303 20 10V4C20.0005 3.46973 20.2114 2.96133 20.5864 2.58637C20.9613 2.21141 21.4697 2.00053 22 2H28C28.5303 2.00053 29.0387 2.21141 29.4136 2.58637C29.7886 2.96133 29.9995 3.46973 30 4V10C29.9995 10.5303 29.7886 11.0387 29.4136 11.4136C29.0387 11.7886 28.5303 11.9995 28 12V12ZM22 4V10H28V4H22Z"
              fill="black"
            /></svg
          >Data</label
        >
        <textarea
          name="data"
          id=""
          rows="5"
          class="Section__input BlockCard__input BlockCard__input--data"
          @keyup="onDataChange()"
          v-model="block.data"
        ></textarea>
      </div>
    </form>
    <div class="BlockCard__footer">
      <div class="BlockCard__timestamp" title="Created on">
        <svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M37.0278 42.7223C38.538 42.7223 39.9864 42.1224 41.0544 41.0545C42.1223 39.9866 42.7222 38.5381 42.7222 37.0279C42.7222 35.5176 42.1223 34.0692 41.0544 33.0013C39.9864 31.9334 38.538 31.3334 37.0278 31.3334C35.5175 31.3334 34.0691 31.9334 33.0012 33.0013C31.9333 34.0692 31.3333 35.5176 31.3333 37.0279C31.3333 38.5381 31.9333 39.9866 33.0012 41.0545C34.0691 42.1224 35.5175 42.7223 37.0278 42.7223ZM37.0278 45.0001C39.1421 45.0001 41.1699 44.1602 42.665 42.6651C44.1601 41.17 45 39.1423 45 37.0279C45 34.9135 44.1601 32.8858 42.665 31.3907C41.1699 29.8956 39.1421 29.0557 37.0278 29.0557C34.9134 29.0557 32.8856 29.8956 31.3906 31.3907C29.8955 32.8858 29.0556 34.9135 29.0556 37.0279C29.0556 39.1423 29.8955 41.17 31.3906 42.6651C32.8856 44.1602 34.9134 45.0001 37.0278 45.0001V45.0001Z"
            fill="black"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M37.0278 33.0417C37.3298 33.0417 37.6195 33.1617 37.8331 33.3753C38.0467 33.5889 38.1667 33.8786 38.1667 34.1806V36.5564L38.9719 37.3616C39.1793 37.5763 39.2941 37.864 39.2915 38.1627C39.2889 38.4613 39.1691 38.7469 38.958 38.9581C38.7468 39.1692 38.4612 39.289 38.1626 39.2916C37.864 39.2942 37.5763 39.1794 37.3615 38.9719L35.8889 37.4994V34.1806C35.8889 33.8786 36.0089 33.5889 36.2225 33.3753C36.436 33.1617 36.7257 33.0417 37.0278 33.0417Z"
            fill="black"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M13.1111 23.361H10.8333V25.6388H13.1111V23.361ZM10.8333 21.0833C10.2292 21.0833 9.64987 21.3232 9.2227 21.7504C8.79554 22.1776 8.55556 22.7569 8.55556 23.361V25.6388C8.55556 26.2429 8.79554 26.8223 9.2227 27.2494C9.64987 27.6766 10.2292 27.9166 10.8333 27.9166H13.1111C13.7152 27.9166 14.2946 27.6766 14.7217 27.2494C15.1489 26.8223 15.3889 26.2429 15.3889 25.6388V23.361C15.3889 22.7569 15.1489 22.1776 14.7217 21.7504C14.2946 21.3232 13.7152 21.0833 13.1111 21.0833H10.8333Z"
            fill="black"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M22.2222 23.361H19.9444V25.6388H22.2222V23.361ZM19.9444 21.0833C19.3403 21.0833 18.761 21.3232 18.3338 21.7504C17.9067 22.1776 17.6667 22.7569 17.6667 23.361V25.6388C17.6667 26.2429 17.9067 26.8223 18.3338 27.2494C18.761 27.6766 19.3403 27.9166 19.9444 27.9166H22.2222C22.8263 27.9166 23.4057 27.6766 23.8329 27.2494C24.26 26.8223 24.5 26.2429 24.5 25.6388V23.361C24.5 22.7569 24.26 22.1776 23.8329 21.7504C23.4057 21.3232 22.8263 21.0833 22.2222 21.0833H19.9444Z"
            fill="black"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M31.3333 23.361H29.0555V25.6388H31.3333V23.361ZM29.0555 21.0833C28.4514 21.0833 27.8721 21.3232 27.4449 21.7504C27.0178 22.1776 26.7778 22.7569 26.7778 23.361V25.6388C26.7778 26.2429 27.0178 26.8223 27.4449 27.2494C27.8721 27.6766 28.4514 27.9166 29.0555 27.9166H31.3333C31.9374 27.9166 32.5168 27.6766 32.944 27.2494C33.3711 26.8223 33.6111 26.2429 33.6111 25.6388V23.361C33.6111 22.7569 33.3711 22.1776 32.944 21.7504C32.5168 21.3232 31.9374 21.0833 31.3333 21.0833H29.0555Z"
            fill="black"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M13.1111 32.4721H10.8333V34.7499H13.1111V32.4721ZM10.8333 30.1943C10.2292 30.1943 9.64987 30.4343 9.2227 30.8615C8.79554 31.2886 8.55556 31.868 8.55556 32.4721V34.7499C8.55556 35.354 8.79554 35.9334 9.2227 36.3605C9.64987 36.7877 10.2292 37.0277 10.8333 37.0277H13.1111C13.7152 37.0277 14.2946 36.7877 14.7217 36.3605C15.1489 35.9334 15.3889 35.354 15.3889 34.7499V32.4721C15.3889 31.868 15.1489 31.2886 14.7217 30.8615C14.2946 30.4343 13.7152 30.1943 13.1111 30.1943H10.8333Z"
            fill="black"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M22.2222 32.4721H19.9444V34.7499H22.2222V32.4721ZM19.9444 30.1943C19.3403 30.1943 18.761 30.4343 18.3338 30.8615C17.9067 31.2886 17.6667 31.868 17.6667 32.4721V34.7499C17.6667 35.354 17.9067 35.9334 18.3338 36.3605C18.761 36.7877 19.3403 37.0277 19.9444 37.0277H22.2222C22.8263 37.0277 23.4057 36.7877 23.8329 36.3605C24.26 35.9334 24.5 35.354 24.5 34.7499V32.4721C24.5 31.868 24.26 31.2886 23.8329 30.8615C23.4057 30.4343 22.8263 30.1943 22.2222 30.1943H19.9444Z"
            fill="black"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M6.27778 10.8334C6.27778 10.5314 6.39777 10.2417 6.61135 10.0281C6.82493 9.81452 7.11461 9.69453 7.41667 9.69453H13.1111V7.41675H7.41667C6.51051 7.41675 5.64147 7.77672 5.00072 8.41747C4.35997 9.05822 4 9.92726 4 10.8334V38.1667C4 39.0729 4.35997 39.9419 5.00072 40.5827C5.64147 41.2234 6.51051 41.5834 7.41667 41.5834H30.4849C29.9992 40.8877 29.6281 40.1187 29.3858 39.3056H7.41667C7.11461 39.3056 6.82493 39.1856 6.61135 38.9721C6.39777 38.7585 6.27778 38.4688 6.27778 38.1667V10.8334ZM35.8889 29.1354C36.6443 29.0273 37.4113 29.0273 38.1667 29.1354V10.8334C38.1667 9.92726 37.8067 9.05822 37.1659 8.41747C36.5252 7.77672 35.6562 7.41675 34.75 7.41675H31.3333V9.69453H34.75C35.0521 9.69453 35.3417 9.81452 35.5553 10.0281C35.7689 10.2417 35.8889 10.5314 35.8889 10.8334V29.1354ZM15.3889 9.69453H27.419V7.41675H15.3889V9.69453Z"
            fill="black"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M38.1667 17.6667H6.27777V15.3889H38.1667V17.6667Z"
            fill="black"
          />
          <path
            d="M10.8333 5.13889C10.8333 4.83684 10.9533 4.54716 11.1669 4.33357C11.3805 4.11999 11.6702 4 11.9722 4C12.2743 4 12.5639 4.11999 12.7775 4.33357C12.9911 4.54716 13.1111 4.83684 13.1111 5.13889V10.8333C13.1111 11.1354 12.9911 11.4251 12.7775 11.6386C12.5639 11.8522 12.2743 11.9722 11.9722 11.9722C11.6702 11.9722 11.3805 11.8522 11.1669 11.6386C10.9533 11.4251 10.8333 11.1354 10.8333 10.8333V5.13889Z"
            fill="black"
          />
          <path
            d="M26.7778 5.13889C26.7778 4.83684 26.8978 4.54716 27.1113 4.33357C27.3249 4.11999 27.6146 4 27.9167 4C28.2187 4 28.5084 4.11999 28.722 4.33357C28.9356 4.54716 29.0555 4.83684 29.0555 5.13889V10.8333C29.0555 11.1354 28.9356 11.4251 28.722 11.6386C28.5084 11.8522 28.2187 11.9722 27.9167 11.9722C27.6146 11.9722 27.3249 11.8522 27.1113 11.6386C26.8978 11.4251 26.7778 11.1354 26.7778 10.8333V5.13889Z"
            fill="black"
          />
        </svg>
        {{ block.timestamp.toLocaleString("en-US", { hour12: false }) }}
      </div>
      <button
        class="Cta BlockCard__mine"
        :class="
          block.isHashValid() || isMining ? 'BlockCard__mine--disabled' : ''
        "
        :style="{
          'background-color': block.isHashValid()
            ? 'var(--grey)'
            : isMining
            ? 'var(--mainColor8)'
            : 'var(--mainColor5)',
        }"
        @click="onMineClicked"
      >
        {{ isMining ? "Mining" : "Mine" }}
      </button>
    </div>
  </div>
</template>

<style lang="scss" scoped>
.BlockCard {
  display: flex;
  flex-direction: column;
  row-gap: var(--gapM);
  padding: var(--layoutPadding);
  border-radius: var(--radiusM);
  background-color: var(--mainColor22);
  width: clamp(
    var(--minWidth) - var(--layoutPadding) * 2,
    calc(100vw - var(--layoutPadding) * 2),
    784px
  );
  opacity: 0;
  animation: fadeScaleInFromAbove var(--revealDuration) var(--mainCubic)
    forwards;
  box-shadow: var(--gapS) var(--gapS) var(--gapR) var(--mainColor21);
  margin-bottom: var(--sectionPadding);
  &__header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    color: var(--mainColor1);
  }
  &__index {
    display: flex;
    align-items: center;
    column-gap: var(--gapS);
    font-size: var(--fontM);
    font-weight: 600;
    letter-spacing: 1px;
    svg {
      width: var(--fontM);
    }
  }

  &__nounce {
    display: flex;
    align-items: center;
    column-gap: var(--gapS);
    font-size: var(--fontS);
    padding: var(--gapS);
    border-radius: var(--radiusS);
    color: var(--mainColor3);
    cursor: not-allowed;
    svg {
      width: calc(var(--fontXXS) - 2px);
      path {
        fill: var(--mainColor3);
      }
    }
  }
  &__form {
    margin-top: var(--gapM);
  }
  &__input {
    &--hash {
      background-color: var(--mainColor21);
    }
    &--data {
      background-color: var(--mainColor20);
    }
  }
  &__inputContainer {
    display: flex;
    flex-direction: column;
    column-gap: var(--gapM);
  }
  &__footer {
    display: flex;
    width: 100%;
    align-items: center;
    justify-content: space-between;
  }
  &__timestamp {
    font-size: var(--fontXS);
    color: var(--mainColor2);
    font-weight: normal;
    letter-spacing: 0;
    display: flex;
    align-items: center;
    column-gap: var(--gapS);
    margin-top: var(--gapS);
    svg {
      width: var(--fontM);
      path {
        fill: var(--mainColor3);
      }
    }
  }
  &__mine {
    display: flex;
    align-items: center;
    justify-content: center;
    column-gap: var(--gapS);
    padding: var(--buttonPaddingS);
    color: var(--mainColor22);
    align-self: center;
    transition: all var(--hoverDuration) var(--mainCubic);
    svg {
      width: var(--fontR);
      path {
        fill: var(--mainColor22);
      }
    }
    cursor: pointer;
    &:hover {
      box-shadow: 4px 5px 4px var(--mainColor15);
      transform: translate3d(-1px, -2px, 0);
    }
    &--disabled {
      cursor: not-allowed;
      &:hover {
        box-shadow: none;
        transform: translate3d(0, 0, 0);
      }
    }
  }
}
</style>
